<!DOCTYPE html>  <html> <head>   <title>006_abstract_factory.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="001_prototypal-inheritance.html">                 001_prototypal-inheritance.js               </a>                                           <a class="source" href="002_extending-prototypes.html">                 002_extending-prototypes.js               </a>                                           <a class="source" href="003_prototype_mixins.html">                 003_prototype_mixins.js               </a>                                           <a class="source" href="004_chaining.html">                 004_chaining.js               </a>                                           <a class="source" href="005_singleton.html">                 005_singleton.js               </a>                                           <a class="source" href="006_abstract_factory.html">                 006_abstract_factory.js               </a>                                           <a class="source" href="007_composite.html">                 007_composite.js               </a>                                           <a class="source" href="008_decorator.html">                 008_decorator.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               006_abstract_factory.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>create our namespace that will hold this example and write it to the global object (in the browsers case the <code>window</code> object).</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AFE</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">AFE</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>for this example we're always going to be creating a type of object based off of this global variable. Whether we create a ConcreateProductA or a ConcreteProductB will be decided in the abstract factory by whether or not this global variable is set to <code>A</code> or <code>B</code>. This will make more sense as we look at the actual implementation of our <code>AbstractFactory</code> object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">globalVariable</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>one thing to note is that because we are passing object as variable through our concrete and abstract modules the ordering of code needs to be set up in a certain order. This is why the concrete implementation are listed before their abstract implementations. As well as why the abstract products are listed before the abstract factory. If you were using a module loader like say Require, where dependencies are managed by the loader, this would not be necessary.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>here we create out concrete implementations of our product A and product B objects.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">ConcreteProductA</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){};</span>
<span class="nx">ConcreteProductA</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({},{</span>
  <span class="nx">name</span><span class="o">:</span><span class="p">{</span> 
    <span class="nx">value</span><span class="o">:</span><span class="s2">&quot;ConcreteProductA&quot;</span> 
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">ConcreteProductB</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){};</span>
<span class="nx">ConcreteProductB</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({},{</span>
  <span class="nx">name</span><span class="o">:</span><span class="p">{</span> 
    <span class="nx">value</span><span class="o">:</span><span class="s2">&quot;ConcreteProductB&quot;</span> 
  <span class="p">}</span>
<span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Here we're creating our abstract product AbstractProductA</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AbstractProductA</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Product</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>the implementation of the AbstractFactory's createProduct method</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">createProduct</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>the interface to make available to the AbstractFactory</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">createProduct</span><span class="o">:</span><span class="nx">createProduct</span>
  <span class="p">};</span>
<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="nx">AFE</span><span class="p">,</span><span class="nx">ConcreteProductA</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Here we're creating our abstract product AbstractProductB</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AbstractProductB</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Product</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>the implementation of the AbstractFactory's createProduct method</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">createProduct</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>the interface to make available to the AbstractFactory</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">createProduct</span><span class="o">:</span><span class="nx">createProduct</span>
  <span class="p">};</span>
<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="nx">AFE</span><span class="p">,</span><span class="nx">ConcreteProductB</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>create our abstract factory that will describe functionality to expose to the application</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AbstractFactory</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">AbstractProductA</span><span class="p">,</span> <span class="nx">AbstractProductB</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>root is a reference to the context that we passed in through when this self executing module is run</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>here we are going to be conditionally running either the AbstractProductA's createProduct method or the AbstractProductB's createProduct method based on our globalVariable or the passed type</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">createProduct</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">cType</span> <span class="o">=</span> <span class="nx">type</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="nx">type</span> <span class="o">:</span> <span class="nx">globalVariable</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">cType</span> <span class="o">===</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">AbstractProductA</span><span class="p">.</span><span class="nx">createProduct</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">cType</span> <span class="o">===</span> <span class="s2">&quot;B&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">AbstractProductB</span><span class="p">.</span><span class="nx">createProduct</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>our interface that we're exposing to the rest of the application</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">root</span><span class="p">.</span><span class="nx">AbstractFactory</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">createProduct</span><span class="o">:</span><span class="nx">createProduct</span>
  <span class="p">};</span>
<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="nx">AFE</span><span class="p">,</span><span class="nx">AbstractProductA</span><span class="p">,</span><span class="nx">AbstractProductB</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>now that we have our Abstract Factory pattern in place we simple call the create product method through it and are returned a concrete implementation based on the global variables value.
We're referencing the AbstractFactory through our namespace because the module purposely doesn't return anything, rather just sets itself on the namespace.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">AFE</span><span class="p">.</span><span class="nx">AbstractFactory</span><span class="p">.</span><span class="nx">createProduct</span><span class="p">().</span><span class="nx">name</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>So why is this pattern important? From this example you could just as easily take the code in the AbstractFactory's createProduct method and place it wherever you needed to create either the concrete product A or B. But say for example that you had more than just A and B, Say you have products that ranged from A to F, and there was more than just one place in your application where you wanted to instantiate these products. Now your duplicating code and have conditional code in multiple places rather than one. Also say that somewhere down the line you needed to add product G and H to the mix. You would essentially have to augment the code in more than one place. </p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>The Abstract Factory pattern gives you away to avoid these common problems as well as drastically simplifies the process in which you create concrete products.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 